close
K = 4;
for K = 1:3:60
   imagesc(reshape(newData(K,:,:,4),100,125))
   hold on;
   pause
end
close
%%
for k = 2:402
[val,idd] = max(abs(a(2:end,k)))
[rowid(k),colid(k),zid(k)] = ind2sub([41,40,71],idd);
end
%%
sampid = randi(size(a,1)-1,5000);
a2 = a(2:end,:);
a3 = a2(sampid,:);
%%
Dis = pdist2([tree2.X,tree2.Y,tree2.Z],[ReconNeuron(1,:)-2;ReconNeuron(2,:)-2;ReconNeuron(3,:)]');
mean(min(Dis))
%%
I = 1:1567;
plot3(tree2.X(I),tree2.Y(I),tree2.Z(I),'b.','MarkerSize',6)
hold on;
plot3(ReconNeuron(1,:)-2,ReconNeuron(2,:)-2,ReconNeuron(3,:),'r*','MarkerSize',8)
grid on;