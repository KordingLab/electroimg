function Index = MinMaxBox(Input,d)
x = size(Input,1);
y = size(Input,2);
z = size(Input,3);
Index = zeros(x,y,z);
J = zeros(x+2d+1,y+2d+1,z+2d+1);
J(d+1:x+d,d+1:y+d,d+1:z+d) = Input;
Input = J;
for i = -d:d
    for j = -d:d
        for k = -d:d
            J = zeros(x+2d+1,y+2d+1,z+2d+1);
            J(d+i+1:x+d+i,d+j+1:y+d+j,d+k+1:z+d+k) = Index;
            J = J - input;
            J = find(J<0);
            [a, b, c] = ind2sub([x,y,z],J);
            J = zeros(x+2d+1,y+2d+1,z+2d+1);
            J(a,:,:) = 1;
            J(:)
            Index = Index + 0;
        end
    end
end
Index(1:d,:,:)=0;
Index(:,1:d,:)=0;
Index(:,:,1:d)=0;
Index(end-d:end,:,:)=0;
Index(:,end-d:end,:)=0;
Index(:,:,end-d:end)=0;
